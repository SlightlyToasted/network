{% extends "network/layout.html" %}
{% load static %}

{% block title %}{{ username }}{% endblock %}

{% block body %}
    <h1>{{ username }}</h1>
    <div class="button-container">
        {% if not_user %}
            {% if is_following %}
                <form action="{% url 'unfollow' user_data.id %}" method="post">
                    {% csrf_token %}
                    <input type="submit" value="Unfollow" class="top-btn">
                </form>
            {% else %}
                <form action="{% url 'follow' user_data.id %}" method="post" class="top-btn">
                    {% csrf_token %}
                    <input class="top-btn" type="submit" value="Follow">
                </form>
            {% endif %}
        {% endif %}
    </div>
    <b>Followers:</b> {{ followers }} <br>
    <b>Following:</b> {{ following }}

    <h2>Posts</h2>
    {% for post in posts %}
        <div id="post-container">
            <a href="{% url 'user' post.user.username 1 %}" class="username-link">{{ post.user.username }}</a>
            {% if not not_user %}
                <br><button id="edit-link-{{ post.id }}" class="edit-link" onclick="edit_post({{ post.id }})">Edit</button>
            {% endif %}

            <div id="content-{{ post.id }}">{{ post.content }}</div>
            
            <div id="textarea-container-{{ post.id }}" style="display: none;">
                <textarea id="textarea-{{ post.id }}">{{ post.content }}</textarea>
                <button onclick="save_post({{ post.id }})">Submit</button>
            </div>
            
            {{ post.timestamp }} <br>
            <button id="like-{{ post.id }}" onclick="toggle_like({{ post.id }})" class="like-btn">â™¥ {{ post.likes_users.count }}</button>
        </div>
    {% endfor %}
    <br>

    <nav aria-label="Page navigation example">
        <ul class="pagination">
            {% if has_prev_page %}
                <li class="page-item"><a class="page-link" href="{% url 'user' username prev_page%}">Previous</a></li>
            {% endif %}
          {% for page in pages %}
            <li class="page-item"><a class="page-link"  href="{% url 'user' username page.number%}">{{ page.number }}</a></li>
          {% endfor %}
          {% if has_next_page %}
            <li class="page-item"><a class="page-link" href="{% url 'user' username next_page %}">Next</a></li>
          {% endif  %}
          
        </ul>
      </nav>


{% endblock %}


{% block script %}
    <script src="{% static 'network/index.js' %}"></script>
{% endblock %}